<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual de Fórmulas Rocket</title>
    <link rel="stylesheet" href="manual-style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="manual-container">
        <header>
            <h1>Manual Interativo de Fórmulas</h1>
            <p>Um guia completo para aprender e testar as funcionalidades do editor.</p>
        </header>

        <nav class="toc">
            <h2>Navegação Rápida</h2>
            <a href="#sintaxe">Sintaxe Básica</a>
            <a href="#funcoes">Funções Suportadas</a>
            <a href="#exemplos">Exemplos Práticos</a>
            <a href="#erros">Erros Comuns e Soluções</a>
        </nav>

        <main>
            <section id="sintaxe">
                <h2>Sintaxe Básica</h2>
                <p>A sintaxe das fórmulas é simples e poderosa. Entenda os componentes principais:</p>
                <ul>
                    <li><strong>Funções:</strong> Como <code>Se()</code>, <code>Maiusculo()</code>, etc. Sempre seguidas por parênteses.</li>
                    <li><strong>Parâmetros:</strong> Valores passados para as funções, separados por vírgula. Ex: <code>SomaData( 'dias' , 10 , Hoje() )</code>.</li>
                    <li><strong>Variáveis:</strong> Referências a campos do sistema, sempre começando com <code>@@</code>. Ex: <code>@@campo_nome</code>.</li>
                    <li><strong>Texto (String):</strong> Qualquer texto literal deve estar entre aspas simples (<code>' '</code>) ou duplas (<code>" "</code>).</li>
                    <li><strong>Operadores:</strong> Use <code>&</code> para concatenar textos, e <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code> para operações matemáticas.</li>
                    <li><strong>Ponto e Vírgula:</strong> Cada comando ou instrução deve terminar com um ponto e vírgula (<code>;</code>).</li>
                </ul>
            </section>

            <section id="funcoes">
                <h2>Funções Suportadas</h2>
                <p>Abaixo está a lista completa de funções, organizadas por categoria.</p>

                <h4>Data e Hora</h4>
                <div class="function-entry">
                    <p><code>Agora()</code></p>
                    <p>Retorna a data e hora atuais.</p>
                </div>
                <div class="function-entry">
                    <p><code>Ano( ‘data’ )</code></p>
                    <p>Extrai o ano de uma data.</p>
                </div>
                <div class="function-entry">
                    <p><code>Data( ‘data’ )</code></p>
                    <p>Converte um valor para o tipo data.</p>
                </div>
                <div class="function-entry">
                    <p><code>Dia( ‘data’ )</code></p>
                    <p>Extrai o dia de uma data.</p>
                </div>
                <div class="function-entry">
                    <p><code>DiaSemana( ‘data’ )</code></p>
                    <p>Retorna o dia da semana por extenso.</p>
                </div>
                <div class="function-entry">
                    <p><code>DifData( ‘unidade’, ‘data1’, ‘data2’ )</code></p>
                    <p>Calcula a diferença entre duas datas em uma unidade específica ('dias', 'meses', 'anos').</p>
                </div>
                <div class="function-entry">
                    <p><code>FormataData( ‘data’, ‘formato’ )</code></p>
                    <p>Formata uma data de acordo com um padrão (ex: 'dd/MM/yyyy').</p>
                </div>
                <div class="function-entry">
                    <p><code>GeraData( ‘dia’, ‘mês’, ‘ano’ )</code></p>
                    <p>Cria uma data a partir de números de dia, mês e ano.</p>
                </div>
                 <div class="function-entry">
                    <p><code>GeraDataComTexto( ‘data’, ‘formato’ )</code></p>
                    <p>Cria uma data a partir de um texto e seu formato.</p>
                </div>
                <div class="function-entry">
                    <p><code>Hoje()</code></p>
                    <p>Retorna a data atual (sem a hora).</p>
                </div>
                <div class="function-entry">
                    <p><code>Hora( ‘data’ )</code></p>
                    <p>Extrai a hora de uma data.</p>
                </div>
                <div class="function-entry">
                    <p><code>Mes( ‘data’ )</code></p>
                    <p>Extrai o mês de uma data.</p>
                </div>
                <div class="function-entry">
                    <p><code>MesExtenso( ‘data’ )</code></p>
                    <p>Retorna o nome do mês por extenso.</p>
                </div>
                <div class="function-entry">
                    <p><code>Minuto( ‘data’ )</code></p>
                    <p>Extrai o minuto de uma data.</p>
                </div>
                <div class="function-entry">
                    <p><code>Segundo( ‘data’ )</code></p>
                    <p>Extrai o segundo de uma data.</p>
                </div>
                <div class="function-entry">
                    <p><code>SomaData( ‘unidade’, ‘valor’, ‘data’ )</code></p>
                    <p>Soma um valor a uma data em uma unidade específica.</p>
                </div>
                <div class="function-entry">
                    <p><code>SubData( ‘unidade’, ‘valor’, ‘data’ )</code></p>
                    <p>Subtrai um valor de uma data em uma unidade específica.</p>
                </div>
                <div class="function-entry">
                    <p><code>Tempo( ‘data’ )</code></p>
                    <p>Retorna a hora de uma data no formato 'HH:mm:ss'.</p>
                </div>
                <div class="function-entry">
                    <p><code>ZeraTempo( ‘data’ )</code></p>
                    <p>Remove a informação de hora de uma data, mantendo apenas o dia.</p>
                </div>

                <h4>Texto</h4>
                <div class="function-entry">
                    <p><code>Caract( ‘código_ascii’ )</code></p>
                    <p>Retorna o caractere correspondente a um código ASCII.</p>
                </div>
                <div class="function-entry">
                    <p><code>Direita( ‘texto’, ‘num_caracteres’ )</code></p>
                    <p>Retorna uma parte do final de um texto.</p>
                </div>
                <div class="function-entry">
                    <p><code>Esquerda( ‘texto’, ‘num_caracteres’ )</code></p>
                    <p>Retorna uma parte do início de um texto.</p>
                </div>
                <div class="function-entry">
                    <p><code>Fonetica( ‘texto’ )</code></p>
                    <p>Retorna a representação fonética de um texto.</p>
                </div>
                <div class="function-entry">
                    <p><code>FormataTexto( ‘texto’, ‘formato’ )</code></p>
                    <p>Aplica uma máscara de formatação a um texto (ex: CPF, CNPJ).</p>
                </div>
                <div class="function-entry">
                    <p><code>Localizar( ‘texto_procurar’, ‘texto_base’, [pos_inicial] )</code></p>
                    <p>Encontra a posição de um texto dentro de outro.</p>
                </div>
                <div class="function-entry">
                    <p><code>Maiusculo( ‘texto’ )</code></p>
                    <p>Converte todo o texto para letras maiúsculas.</p>
                </div>
                <div class="function-entry">
                    <p><code>Meio( ‘texto’, ‘pos_inicial’, ‘num_caracteres’ )</code></p>
                    <p>Extrai uma parte do meio de um texto.</p>
                </div>
                <div class="function-entry">
                    <p><code>Minusculo( ‘texto’ )</code></p>
                    <p>Converte todo o texto para letras minúsculas.</p>
                </div>
                <div class="function-entry">
                    <p><code>Mudar( ‘texto’, ‘antigo’, ‘novo’ )</code></p>
                    <p>Substitui ocorrências de um texto por outro.</p>
                </div>
                <div class="function-entry">
                    <p><code>PriMaiusculo( ‘texto’ )</code></p>
                    <p>Converte a primeira letra de cada palavra para maiúscula.</p>
                </div>
                <div class="function-entry">
                    <p><code>Replicar( ‘texto’, ‘vezes’ )</code></p>
                    <p>Repete um texto um determinado número de vezes.</p>
                </div>
                <div class="function-entry">
                    <p><code>Reverso( ‘texto’ )</code></p>
                    <p>Inverte a ordem dos caracteres de um texto.</p>
                </div>
                <div class="function-entry">
                    <p><code>Tamanho( ‘texto’ )</code></p>
                    <p>Retorna o número de caracteres de um texto.</p>
                </div>

                <h4>Matemática e Numérica</h4>
                <div class="function-entry">
                    <p><code>Abs( ‘numero’ )</code></p>
                    <p>Retorna o valor absoluto (positivo) de um número.</p>
                </div>
                <div class="function-entry">
                    <p><code>Arredondar( ‘numero’, ‘precisão’ )</code></p>
                    <p>Arredonda um número para uma quantidade de casas decimais.</p>
                </div>
                <div class="function-entry">
                    <p><code>FormataNumero( ‘numero’, ‘formato’ )</code></p>
                    <p>Formata um número com um padrão específico.</p>
                </div>
                <div class="function-entry">
                    <p><code>MoedaExtenso( ‘numero’ )</code></p>
                    <p>Converte um valor monetário para seu equivalente por extenso.</p>
                </div>
                <div class="function-entry">
                    <p><code>Raiz( ‘numero’ )</code></p>
                    <p>Calcula a raiz quadrada de um número.</p>
                </div>
                <div class="function-entry">
                    <p><code>Truncar( ‘numero’, ‘precisão’ )</code></p>
                    <p>Trunca um número para uma quantidade de casas decimais, sem arredondar.</p>
                </div>
                <div class="function-entry">
                    <p><code>ValorExtenso( ‘numero’ )</code></p>
                    <p>Converte um número para seu equivalente por extenso.</p>
                </div>

                <h4>Validação e Conversão</h4>
                <div class="function-entry">
                    <p><code>Codigo( ‘texto’ )</code></p>
                    <p>Retorna o código ASCII do primeiro caractere de um texto.</p>
                </div>
                <div class="function-entry">
                    <p><code>SemelhancaNomes( ‘texto1’, ‘texto2’ )</code></p>
                    <p>Calcula a semelhança fonética entre dois nomes.</p>
                </div>
                <div class="function-entry">
                    <p><code>Texto( ‘valor’ )</code></p>
                    <p>Converte um número ou lógico para texto.</p>
                </div>
                <div class="function-entry">
                    <p><code>ValidaCNH( ‘texto’ )</code></p>
                    <p>Verifica se um número de CNH é válido.</p>
                </div>
                <div class="function-entry">
                    <p><code>ValidaCNPJ( ‘texto’ )</code></p>
                    <p>Verifica se um número de CNPJ é válido.</p>
                </div>
                <div class="function-entry">
                    <p><code>ValidaCPF( ‘texto’ )</code></p>
                    <p>Verifica se um número de CPF é válido.</p>
                </div>
                <div class="function-entry">
                    <p><code>Valor( ‘texto’ )</code></p>
                    <p>Converte um texto que representa um número para o tipo numérico.</p>
                </div>

                <h4>Lógica e Estrutura</h4>
                <div class="function-entry">
                    <p><code>Se( ‘teste_lógico’, ‘valor_verdadeiro’, ‘valor_falso’ )</code></p>
                    <p>Executa um de dois valores com base em uma condição lógica.</p>
                </div>
                 <div class="function-entry">
                    <p><code>Copiar( ‘destino’, ‘origem’ )</code></p>
                    <p>Copia o valor de uma variável de origem para uma de destino.</p>
                </div>

            </section>

            <section id="exemplos">
                <h2>Exemplos Práticos</h2>
                <p>A melhor forma de aprender é praticando. Use os botões para enviar os exemplos direto para o editor.</p>
                
                <div class="example">
                    <div class="example-left">
                        <h4>Concatenar Nome e Sobrenome</h4>
                        <p>Junta o nome e o sobrenome de um cliente em um único campo de texto.</p>
                        <pre><code><span class="func">Maiusculo</span>(<span class="var">@@nome</span> & <span class="str">' '</span> & <span class="var">@@sobrenome</span>);</code></pre>
                        <button class="test-btn" data-formula="Maiusculo(@@nome & ' ' & @@sobrenome);">Testar no Editor</button>
                    </div>
                    <div class="example-right">
                        <h4>Resultado Esperado</h4>
                        <p>Se <code>@@nome</code> for "João" e <code>@@sobrenome</code> for "Silva", o resultado será "JOÃO SILVA".</p>
                    </div>
                </div>

                <div class="example">
                    <div class="example-left">
                        <h4>Calcular a data de vencimento</h4>
                        <p>Soma 30 dias à data de emissão de um documento para obter o vencimento.</p>
                        <pre><code><span class="func">SomaData</span>(<span class="str">'dias'</span>, <span class="num">30</span>, <span class="var">@@data_emissao</span>);</code></pre>
                        <button class="test-btn" data-formula="SomaData('dias', 30, @@data_emissao);">Testar no Editor</button>
                    </div>
                    <div class="example-right">
                        <h4>Resultado Esperado</h4>
                        <p>Se <code>@@data_emissao</code> for 15/10/2025, o resultado será a data 14/11/2025.</p>
                    </div>
                </div>
            </section>

            <section id="erros">
                <h2>Erros Comuns e Soluções</h2>
                <p>Veja alguns dos erros mais frequentes e como corrigi-los.</p>

                <div class="example">
                    <div class="example-left">
                        <h4>Erro: Ponto e vírgula ausente</h4>
                        <p>Toda instrução precisa terminar com <code>;</code>.</p>
                        <pre><code class="error-code">Se(@@valor > 100, 'Alto', 'Baixo')</code></pre>
                        <h4>Correção</h4>
                        <pre><code>Se(@@valor > 100, 'Alto', 'Baixo');</code></pre>
                        <button class="test-btn" data-formula="Se(@@valor > 100, 'Alto', 'Baixo')">Testar Erro</button>
                    </div>
                    <div class="example-right">
                        <h4>Explicação</h4>
                        <p>O validador irá detectar a ausência do ponto e vírgula e sugerir a correção automática.</p>
                    </div>
                </div>

                 <div class="example">
                    <div class="example-left">
                        <h4>Erro: Aspas ausentes em texto</h4>
                        <p>Valores de texto literal precisam de aspas.</p>
                        <pre><code class="error-code">@@campo = Ativo;</code></pre>
                        <h4>Correção</h4>
                        <pre><code>@@campo = 'Ativo';</code></pre>
                        <button class="test-btn" data-formula="@@campo = Ativo;">Testar Erro</button>
                    </div>
                    <div class="example-right">
                        <h4>Explicação</h4>
                        <p>O validador identifica que "Ativo" provavelmente deveria ser um texto e sugere adicionar aspas.</p>
                    </div>
                </div>
            </section>
        </main>
    </div>
    <script src="manual-script.js" defer></script>
    <a href="#top" id="back-to-top-btn" class="back-to-top-btn" title="Voltar ao topo">&#8679;</a>
</body>
</html>
