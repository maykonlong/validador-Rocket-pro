<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual de Treinamento - Fórmulas Rocket</title>
    <link rel="stylesheet" href="manual-style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
                <h1>Manual de Treinamento</h1>
            </div>
            <p>Seu guia para dominar o Editor de Fórmulas Rocket</p>
        </header>

        <section id="introducao">
            <h2>1. Introdução</h2>
            <p>Bem-vindo ao Editor de Fórmulas Rocket! Esta ferramenta foi projetada para ser um assistente inteligente, ajudando você a escrever, validar e corrigir fórmulas complexas de forma rápida e eficiente. Este manual irá guiá-lo por todos os recursos disponíveis.</p>
        </section>

        <section id="interface">
            <h2>2. Conhecendo a Interface</h2>
            <p>A interface é simples e dividida em duas áreas principais:</p>
            <ul>
                <li><strong>Área de Edição:</strong> O campo de texto onde você escreve e edita suas fórmulas.</li>
                <li><strong>Área de Resultados:</strong> Abaixo do editor, onde o validador exibe o status, os erros encontrados e as sugestões de correção em tempo real.</li>
            </ul>
        </section>

        <section id="primeiro-script">
            <h2>3. Seu Primeiro Script: Passo a Passo</h2>
            <p>Vamos criar uma fórmula que cumprimenta um usuário e mostra a data atual. Isso nos ajudará a entender os conceitos na prática.</p>
            <div class="step">
                <h4>Passo 1: Comece com um texto fixo (String)</h4>
                <p>Toda string deve estar entre aspas. Não se esqueça do ponto e vírgula no final.</p>
                <pre><code class="language-formula">"Olá, ";</code><button class="copy-btn" title="Copiar"></button></pre>
            </div>
            <div class="step">
                <h4>Passo 2: Adicione uma variável</h4>
                <p>Use o operador de concatenação <code>&</code> para unir a string com a variável do nome do usuário. Lembre-se que variáveis sempre começam com <code>@@</code>.</p>
                <pre><code class="language-formula">"Olá, " & @@CTX.NOME_USUARIO;</code><button class="copy-btn" title="Copiar"></button></pre>
            </div>
            <div class="step">
                <h4>Passo 3: Use uma função</h4>
                <p>Vamos adicionar a data atual usando a função <code>Hoje()</code>. Continue usando o operador <code>&</code> para unir tudo.</p>
                <pre><code class="language-formula">"Olá, " & @@CTX.NOME_USUARIO & ". Hoje é dia " & Hoje();</code><button class="copy-btn" title="Copiar"></button></pre>
                <p><strong>Pronto!</strong> Você criou sua primeira fórmula funcional, combinando texto, uma variável e uma função.</p>
            </div>
        </section>

        <section id="sintaxe">
            <h2>3. A Anatomia de uma Fórmula</h2>
            <p>Entender a estrutura básica é o primeiro passo para escrever qualquer fórmula.</p>
            
            <h3>Funções</h3>
            <p>O bloco de construção principal. Possuem um nome e recebem argumentos entre parênteses.</p>
            <pre><code>NomeDaFuncao( argumento1, argumento2 );</code></pre>

            <h3>Variáveis</h3>
            <p>Representam dados do sistema. Elas <strong>sempre</strong> devem começar com <code>@@</code>.</p>
            <pre><code>@@CTX.NOME_CLIENTE</code></pre>

            <h3>Strings (Texto)</h3>
            <p>Valores de texto fixos devem estar entre aspas duplas.</p>
            <pre><code>"Olá, Mundo!"</code></pre>

            <h3>Concatenação (Unir Textos)</h3>
            <p>Para unir diferentes partes (variáveis e textos), use o operador <code>&</code>.</p>
            <pre><code>"Cliente: " & @@CTX.NOME_CLIENTE & " (ativo)";</code></pre>

            <h3>Ponto e Vírgula (;)</h3>
            <p>Toda fórmula <strong>deve</strong> terminar com um ponto e vírgula.</p>
        </section>

        <section id="operadores">
            <h2>4. Operadores Essenciais</h2>
            <p>Operadores são símbolos que executam ações entre valores e variáveis.</p>
            <ul>
                <li><strong>Aritméticos:</strong> Usados para cálculos matemáticos. Ex: <code>+</code> (soma), <code>-</code> (subtração), <code>*</code> (multiplicação), <code>/</code> (divisão).</li>
                <li><strong>Comparação:</strong> Usados em testes lógicos, principalmente com a função <code>Se()</code>. Ex: <code>=</code> (igual), <code><></code> (diferente), <code>></code> (maior que), <code><</code> (menor que).</li>
                <li><strong>Lógicos:</strong> Usados para combinar múltiplos testes lógicos. Ex: <code>E</code> (ambas as condições devem ser verdadeiras), <code>OU</code> (pelo menos uma condição deve ser verdadeira).</li>
                <li><strong>Concatenação:</strong> O operador <code>&</code> é usado exclusivamente para unir textos e variáveis.</li>
            </ul>
        </section>

        <section id="erros-comuns">
            <h2>4. Erros Comuns e Como Corrigi-los</h2>
            <p>O validador é seu melhor amigo. Ele identifica erros e sugere correções. Aqui estão os mais comuns:</p>
            <div class="error-example">
                <h4>Erro: Falta de Operador de Concatenação</h4>
                <p><strong>Incorreto:</strong> <code>@@VARIAVEL1 "TEXTO"</code></p>
                <p><strong>Causa:</strong> Dois termos juntos sem um operador para uni-los.</p>
                <p><strong>Correção Sugerida:</strong> O validador irá sugerir adicionar o <code>&</code> entre eles.</p>
                <p><strong>Correto:</strong> <code>@@VARIAVEL1 & "TEXTO"</code></p>
            </div>
            <div class="error-example">
                <h4>Erro: String não Fechada</h4>
                <p><strong>Incorreto:</strong> <code>Se( @@VAR = "1", "OK , "ERRO" )</code></p>
                <p><strong>Causa:</strong> Uma aspa de fechamento está faltando antes da vírgula.</p>
                <p><strong>Correção Sugerida:</strong> O validador irá sugerir fechar a string no local correto.</p>
                <p><strong>Correto:</strong> <code>Se( @@VAR = "1", "OK", "ERRO" )</code></p>
            </div>
            <div class="error-example">
                <h4>Erro: Variável Inválida</h4>
                <p><strong>Incorreto:</strong> <code>@CTX.NOME</code></p>
                <p><strong>Causa:</strong> A variável começou com apenas um <code>@</code>.</p>
                <p><strong>Correção Sugerida:</strong> O validador irá sugerir a correção para <code>@@</code>.</p>
                <p><strong>Correto:</strong> <code>@@CTX.NOME</code></p>
            </div>
        </section>

        <section id="referencia">
            <h2>6. Referência de Funções</h2>
            <p>Abaixo está uma lista de todas as funções disponíveis no sistema.</p>
            <input type="text" id="searchInput" onkeyup="filterFunctions()" placeholder="Pesquisar por função...">
            <div id="functions-list">
                <!-- Os cards de função serão inseridos aqui via JavaScript -->
            </div>
        </section>

    </div>

    <script>
        const FUNCTIONS_METADATA = {
            "SE": { signature: "Se( teste_lógico, valor_se_verdadeiro, valor_se_falso )", description: "Retorna um valor se a condição for VERDADEIRA e outro valor se for FALSA.", category: "Condicional", returns: 'any' },
            "DIA": { signature: "Dia( data )", description: "Retorna o dia de uma data (1-31).", category: "Data", returns: 'numeric' },
            "MES": { signature: "Mes( data )", description: "Retorna o mês de uma data (1-12).", category: "Data", returns: 'numeric' },
            "ANO": { signature: "Ano( data )", description: "Retorna o ano de uma data.", category: "Data", returns: 'numeric' },
            "HORA": { signature: "Hora( data )", description: "Retorna a hora de uma data (0-23).", category: "Data", returns: 'numeric' },
            "MINUTO": { signature: "Minuto( data )", description: "Retorna o minuto de uma data (0-59).", category: "Data", returns: 'numeric' },
            "SEGUNDO": { signature: "Segundo( data )", description: "Retorna o segundo de uma data (0-59).", category: "Data", returns: 'numeric' },
            "AGORA": { signature: "Agora()", description: "Retorna a data e hora atuais do sistema.", category: "Data", returns: 'date' },
            "DATA": { signature: "Data( data_hora )", description: "Extrai apenas a parte da data (dia, mês, ano) de um valor de data e hora.", category: "Data", returns: 'text' },
            "DIASEMANA": { signature: "DiaSemana( data )", description: "Retorna o nome do dia da semana para uma data (ex: 'Segunda-feira').", category: "Data", returns: 'text' },
            "DIFDATA": { signature: "DifData( unidade, data_inicial, data_final )", description: "Calcula a diferença entre duas datas na unidade especificada ('A', 'M', 'D', 'H', 'N', 'S').", category: "Data", returns: 'numeric' },
            "FORMATADATA": { signature: "FormataData( data, formato )", description: "Formata uma data em um texto de acordo com uma máscara (ex: 'DMA', 'HNS').", category: "Data", returns: 'text' },
            "GERADATACOMTEXTO": { signature: "GeraDataComTexto( texto_data, formato )", description: "Cria um valor de data a partir de um texto formatado (ex: '31/12/2025').", category: "Data", returns: 'date' },
            "GERADATA": { signature: "GeraData( dia, mes, ano )", description: "Cria uma data a partir de números de dia, mês e ano.", category: "Data", returns: 'date' },
            "HOJE": { signature: "Hoje()", description: "Retorna a data atual do sistema (sem a hora).", category: "Data", returns: 'date' },
            "MESEXTENSO": { signature: "MesExtenso( data )", description: "Retorna o nome do mês por extenso (ex: 'Janeiro').", category: "Data", returns: 'text' },
            "REFORMATADATA": { signature: "ReFormataData( data, formato_entrada, formato_saida )", description: "Converte uma data de um formato de texto para outro.", category: "Data", returns: 'text' },
            "SOMADATA": { signature: "SomaData( unidade, valor, data )", description: "Adiciona um valor a uma data em uma unidade específica ('A', 'M', 'D', 'H', 'N', 'S').", category: "Data", returns: 'date' },
            "SUBDATA": { signature: "SubData( unidade, valor, data )", description: "Subtrai um valor de uma data em uma unidade específica ('A', 'M', 'D', 'H', 'N', 'S').", category: "Data", returns: 'date' },
            "TEMPO": { signature: "Tempo( data_hora )", description: "Extrai apenas a parte da hora (hora, minuto, segundo) de um valor de data e hora.", category: "Data", returns: 'text' },
            "ZERATEMPO": { signature: "ZeraTempo( data )", description: "Zera a parte de tempo (hora, minuto, segundo) de uma data.", category: "Data", returns: 'date' },
            "ABS": { signature: "Abs( numero )", description: "Retorna o valor absoluto (positivo) de um número.", category: "Matemática", returns: 'numeric' },
            "ARREDONDAR": { signature: "Arredondar( numero, precisao )", description: "Arredonda um número para um número especificado de casas decimais.", category: "Matemática", returns: 'numeric' },
            "CARACT": { signature: "Caract( codigo_ascii )", description: "Retorna o caractere correspondente a um código numérico ASCII.", category: "Texto", returns: 'text' },
            "FORMATANUMERO": { signature: "FormataNumero( numero, formato )", description: "Formata um número como texto usando uma máscara (ex: '$2' para moeda).", category: "Matemática", returns: 'text' },
            "MOEDAEXTENSO": { signature: "MoedaExtenso( numero )", description: "Converte um valor numérico para seu equivalente em texto por extenso, como em um cheque.", category: "Matemática", returns: 'text' },
            "RAIZ": { signature: "Raiz( numero )", description: "Calcula a raiz quadrada de um número.", category: "Matemática", returns: 'numeric' },
            "TEXTO": { signature: "Texto( valor )", description: "Converte um valor numérico ou lógico para sua representação em texto.", category: "Texto", returns: 'text' },
            "TRUNCAR": { signature: "Truncar( numero, precisao )", description: "Remove as casas decimais de um número sem arredondar.", category: "Matemática", returns: 'numeric' },
            "VALOREXTENSO": { signature: "ValorExtenso( numero )", description: "Converte um número para seu equivalente em texto por extenso.", category: "Matemática", returns: 'text' },
            "VALIDACPF": { signature: "ValidaCPF( texto_cpf )", description: "Verifica se um texto corresponde a um CPF válido. Retorna 'VERDADEIRO' ou 'FALSO'.", category: "Validação", returns: 'text' },
            "VALIDACNPJ": { signature: "ValidaCNPJ( texto_cnpj )", description: "Verifica se um texto corresponde a um CNPJ válido. Retorna 'VERDADEIRO' ou 'FALSO'.", category: "Validação", returns: 'text' },
            "VALIDACNH": { signature: "ValidaCNH( texto_cnh )", description: "Verifica se um texto corresponde a uma CNH válida. Retorna 'VERDADEIRO' ou 'FALSO'.", category: "Validação", returns: 'text' },
            "CODIGO": { signature: "Codigo( texto )", description: "Retorna o código numérico ASCII do primeiro caractere de um texto.", category: "Texto", returns: 'numeric' },
            "COPIAR": { signature: "Copiar( destino, origem )", description: "Copia o valor da origem para o destino. Usado para atribuir valores a variáveis.", category: "Lógica", returns: 'any' },
            "DIREITA": { signature: "Direita( texto, num_caracteres )", description: "Retorna um número especificado de caracteres a partir do final de um texto.", category: "Texto", returns: 'text' },
            "ESQUERDA": { signature: "Esquerda( texto, num_caracteres )", description: "Retorna um número especificado de caracteres a partir do início de um texto.", category: "Texto", returns: 'text' },
            "FONETICA": { signature: "Fonetica( texto )", description: "Retorna uma representação fonética de um texto.", category: "Texto", returns: 'text' },
            "FORMATATEXTO": { signature: "FormataTexto( texto, formato )", description: "Aplica uma máscara de formatação a um texto (ex: para CEP, telefone).", category: "Texto", returns: 'text' },
            "LOCALIZAR": { signature: "Localizar( texto_procurado, texto_base, pos_inicial )", description: "Encontra a posição inicial de um texto dentro de outro, da esquerda para a direita.", category: "Texto", returns: 'numeric' },
            "LOCALIZARREV": { signature: "LocalizarRev( texto_procurado, texto_base, pos_inicial )", description: "Encontra a posição inicial de um texto dentro de outro, da direita para a esquerda.", category: "Texto", returns: 'numeric' },
            "MAIUSCULO": { signature: "Maiusculo( texto )", description: "Converte todo o texto para letras maiúsculas.", category: "Texto", returns: 'text' },
            "MEIO": { signature: "Meio( texto, pos_inicial, num_caracteres )", description: "Extrai uma parte de um texto a partir de uma posição e tamanho definidos.", category: "Texto", returns: 'text' },
            "MINUSCULO": { signature: "Minusculo( texto )", description: "Converte todo o texto para letras minúsculas.", category: "Texto", returns: 'text' },
            "MUDAR": { signature: "Mudar( texto_base, texto_antigo, texto_novo )", description: "Substitui todas as ocorrências de um texto por outro dentro do texto base.", category: "Texto", returns: 'text' },
            "PRIMAISCULO": { signature: "PriMaiusculo( texto )", description: "Converte a primeira letra de cada palavra para maiúscula.", category: "Texto", returns: 'text' },
            "REPLICAR": { signature: "Replicar( texto, repeticoes )", description: "Repete um texto um determinado número de vezes.", category: "Texto", returns: 'text' },
            "REVERSO": { signature: "Reverso( texto )", description: "Inverte a ordem dos caracteres de um texto.", category: "Texto", returns: 'text' },
            "SEMELHANCANOME": { signature: "SemelhancaNomes( texto1, texto2 )", description: "Calcula o percentual de semelhança entre dois textos (algoritmo Levenshtein).", category: "Texto", returns: 'numeric' },
            "SUPRIMIR": { signature: "Suprimir( texto, caracteres_a_suprimir )", description: "Remove todos os caracteres especificados de um texto.", category: "Texto", returns: 'text' },
            "TAMANHO": { signature: "Tamanho( texto )", description: "Retorna o número de caracteres em um texto.", category: "Texto", returns: 'numeric' },
            "VALOR": { signature: "Valor( texto )", description: "Converte um texto que representa um número para um valor numérico.", category: "Texto", returns: 'numeric' },
        };

        function populateFunctionsList() {
            const listContainer = document.getElementById('functions-list');
            listContainer.innerHTML = ''; // Limpa a lista

            for (const funcName in FUNCTIONS_METADATA) {
                const funcData = FUNCTIONS_METADATA[funcName];
                
                const card = document.createElement('div');
                card.className = 'function-card';
                card.setAttribute('data-name', funcName.toUpperCase());

                card.innerHTML = `
                    <div class="card-header">
                        <h3>${funcName}</h3>
                        <div class="tags">
                            <span class="tag tag-category">${funcData.category}</span>
                            <span class="tag tag-return return-${funcData.returns}">${funcData.returns}</span>
                        </div>
                    </div>
                    <p class="description">${funcData.description}</p>
                    <pre><code class="language-formula">${funcData.signature}</code><button class="copy-btn" title="Copiar"></button></pre>
                `;
                listContainer.appendChild(card);
            }
        }

        function filterFunctions() {
            const input = document.getElementById('searchInput');
            const filter = input.value.toUpperCase();
            const cards = document.querySelectorAll('.function-card');

            cards.forEach(card => {
                const funcName = card.getAttribute('data-name');
                if (funcName.includes(filter)) {
                    card.style.display = "";
                } else {
                    card.style.display = "none";
                }
            });
        }

        function setupCopyButtons() {
            document.body.addEventListener('click', function(event) {
                if (event.target.classList.contains('copy-btn')) {
                    const pre = event.target.closest('pre');
                    const code = pre.querySelector('code');
                    navigator.clipboard.writeText(code.innerText).then(() => {
                        event.target.classList.add('copied');
                        setTimeout(() => {
                            event.target.classList.remove('copied');
                        }, 1500);
                    });
                }
            });
        }

        window.onload = () => {
            populateFunctionsList();
            setupCopyButtons();
        };
    </script>
</body>
</html>